{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.17", "generated_at": "2025-12-28T22:08:36.163252Z", "invocation_id": "6b10ce57-ece0-4bb8-b417-bb3c33b93ae2", "invocation_started_at": "2025-12-28T22:08:35.691449Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.021180Z", "completed_at": "2025-12-28T22:08:36.024930Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.025078Z", "completed_at": "2025-12-28T22:08:36.025084Z"}], "thread_id": "Thread-1", "execution_time": 0.004253387451171875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.take_home_dbt.bronze__customers", "compiled": true, "compiled_code": "select \n    try_cast(id as string) as customer_id, \n    try_cast(signup_date as date) as customer_signup_date, \n    try_cast(status as string) as customer_status,\n    try_cast(region as string) as customer_region,\n    'raw_data/customers.csv' as data_source\nfrom 'data/customers.csv'", "relation_name": "\"dev\".\"main\".\"bronze__customers\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.025891Z", "completed_at": "2025-12-28T22:08:36.027191Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.027327Z", "completed_at": "2025-12-28T22:08:36.027330Z"}], "thread_id": "Thread-1", "execution_time": 0.0018579959869384766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.take_home_dbt.bronze__plans", "compiled": true, "compiled_code": "select \n    try_cast(id as string) as plan_id, \n    try_cast(plan_name as string) as plan_name, \n    try_cast(monthly_price as decimal(10,2)) as plan_monthly_price,\n    'raw_data/plans.csv' as data_source\nfrom 'data/plans.csv'", "relation_name": "\"dev\".\"main\".\"bronze__plans\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.028027Z", "completed_at": "2025-12-28T22:08:36.029255Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.029387Z", "completed_at": "2025-12-28T22:08:36.029390Z"}], "thread_id": "Thread-1", "execution_time": 0.0017158985137939453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.take_home_dbt.bronze__subscriptions", "compiled": true, "compiled_code": "select \n    try_cast(id as string) as subscription_id, \n    try_cast(customer_id as string) as customer_id,\n    try_cast(plan_id as string) as plan_id, \n    try_cast(start_date as date) as subscription_start_date,\n    try_cast(end_date as date) as subscription_end_date,\n    'raw_data/subscriptions.csv' as data_source\nfrom 'data/subscriptions.csv'", "relation_name": "\"dev\".\"main\".\"bronze__subscriptions\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.030080Z", "completed_at": "2025-12-28T22:08:36.031699Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.031826Z", "completed_at": "2025-12-28T22:08:36.031829Z"}], "thread_id": "Thread-1", "execution_time": 0.0020961761474609375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.take_home_dbt.silver__dim_customers", "compiled": true, "compiled_code": "select \n    customer_id, \n    customer_signup_date, \n    customer_status,\n    customer_region\nfrom \"dev\".\"main\".\"bronze__customers\"", "relation_name": "\"dev\".\"main\".\"silver__dim_customers\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.032498Z", "completed_at": "2025-12-28T22:08:36.037343Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.037499Z", "completed_at": "2025-12-28T22:08:36.037503Z"}], "thread_id": "Thread-1", "execution_time": 0.0053369998931884766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.accepted_values_bronze__customers_customer_status__active__canceled.0982f30406", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_status as value_field,\n        count(*) as n_records\n\n    from \"dev\".\"main\".\"bronze__customers\"\n    group by customer_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'active','canceled'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.038202Z", "completed_at": "2025-12-28T22:08:36.041693Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.041835Z", "completed_at": "2025-12-28T22:08:36.041839Z"}], "thread_id": "Thread-1", "execution_time": 0.0039539337158203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.not_null_bronze__customers_customer_id.c34693d680", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"dev\".\"main\".\"bronze__customers\"\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.042498Z", "completed_at": "2025-12-28T22:08:36.044203Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.044333Z", "completed_at": "2025-12-28T22:08:36.044337Z"}], "thread_id": "Thread-1", "execution_time": 0.0021419525146484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.not_null_bronze__customers_customer_signup_date.270f2c397e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_signup_date\nfrom \"dev\".\"main\".\"bronze__customers\"\nwhere customer_signup_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.044960Z", "completed_at": "2025-12-28T22:08:36.046615Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.046747Z", "completed_at": "2025-12-28T22:08:36.046750Z"}], "thread_id": "Thread-1", "execution_time": 0.002086162567138672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.not_null_bronze__customers_customer_status.7c036d3593", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_status\nfrom \"dev\".\"main\".\"bronze__customers\"\nwhere customer_status is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.047382Z", "completed_at": "2025-12-28T22:08:36.050334Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.050472Z", "completed_at": "2025-12-28T22:08:36.050475Z"}], "thread_id": "Thread-1", "execution_time": 0.0033910274505615234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.unique_bronze__customers_customer_id.134671ef0b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"dev\".\"main\".\"bronze__customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.051102Z", "completed_at": "2025-12-28T22:08:36.052274Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.052398Z", "completed_at": "2025-12-28T22:08:36.052401Z"}], "thread_id": "Thread-1", "execution_time": 0.0015909671783447266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.take_home_dbt.silver__dim_plans", "compiled": true, "compiled_code": "select \n    plan_id, \n    plan_name, \n    plan_monthly_price\nfrom \"dev\".\"main\".\"bronze__plans\"", "relation_name": "\"dev\".\"main\".\"silver__dim_plans\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.053075Z", "completed_at": "2025-12-28T22:08:36.056476Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.056622Z", "completed_at": "2025-12-28T22:08:36.056625Z"}], "thread_id": "Thread-1", "execution_time": 0.0038840770721435547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.dbt_utils_accepted_range_bronze__plans_plan_monthly_price__True__0.93dc451a6f", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from \"dev\".\"main\".\"bronze__plans\"\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not plan_monthly_price >= 0\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.057261Z", "completed_at": "2025-12-28T22:08:36.058878Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.059008Z", "completed_at": "2025-12-28T22:08:36.059011Z"}], "thread_id": "Thread-1", "execution_time": 0.002048015594482422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.not_null_bronze__plans_plan_id.65f483a822", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_id\nfrom \"dev\".\"main\".\"bronze__plans\"\nwhere plan_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.059635Z", "completed_at": "2025-12-28T22:08:36.061221Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.061349Z", "completed_at": "2025-12-28T22:08:36.061351Z"}], "thread_id": "Thread-1", "execution_time": 0.0020096302032470703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.not_null_bronze__plans_plan_monthly_price.375f34d0fe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_monthly_price\nfrom \"dev\".\"main\".\"bronze__plans\"\nwhere plan_monthly_price is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.061971Z", "completed_at": "2025-12-28T22:08:36.063603Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.063728Z", "completed_at": "2025-12-28T22:08:36.063731Z"}], "thread_id": "Thread-1", "execution_time": 0.002051115036010742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.not_null_bronze__plans_plan_name.40f50251a0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_name\nfrom \"dev\".\"main\".\"bronze__plans\"\nwhere plan_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.064379Z", "completed_at": "2025-12-28T22:08:36.066446Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.066572Z", "completed_at": "2025-12-28T22:08:36.066575Z"}], "thread_id": "Thread-1", "execution_time": 0.0024878978729248047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.unique_bronze__plans_plan_id.8649abf1a0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    plan_id as unique_field,\n    count(*) as n_records\n\nfrom \"dev\".\"main\".\"bronze__plans\"\nwhere plan_id is not null\ngroup by plan_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.067206Z", "completed_at": "2025-12-28T22:08:36.070405Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.070542Z", "completed_at": "2025-12-28T22:08:36.070545Z"}], "thread_id": "Thread-1", "execution_time": 0.0036399364471435547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.dbt_utils_expression_is_true_bronze__subscriptions_subscription_end_date_is_null_or_subscription_end_date_subscription_start_date_.53e3da7b26", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"dev\".\"main\".\"bronze__subscriptions\"\n\nwhere not(subscription_end_date is null or subscription_end_date >= subscription_start_date)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.071187Z", "completed_at": "2025-12-28T22:08:36.072819Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.073024Z", "completed_at": "2025-12-28T22:08:36.073029Z"}], "thread_id": "Thread-1", "execution_time": 0.0021729469299316406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.not_null_bronze__subscriptions_customer_id.cf4ce22412", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"dev\".\"main\".\"bronze__subscriptions\"\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.073780Z", "completed_at": "2025-12-28T22:08:36.075597Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.075742Z", "completed_at": "2025-12-28T22:08:36.075745Z"}], "thread_id": "Thread-1", "execution_time": 0.002301931381225586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.not_null_bronze__subscriptions_plan_id.ef7db1dc3d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_id\nfrom \"dev\".\"main\".\"bronze__subscriptions\"\nwhere plan_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.076449Z", "completed_at": "2025-12-28T22:08:36.078188Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.078321Z", "completed_at": "2025-12-28T22:08:36.078324Z"}], "thread_id": "Thread-1", "execution_time": 0.002221822738647461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.not_null_bronze__subscriptions_subscription_id.6de80f1681", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"dev\".\"main\".\"bronze__subscriptions\"\nwhere subscription_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.078986Z", "completed_at": "2025-12-28T22:08:36.081196Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.081329Z", "completed_at": "2025-12-28T22:08:36.081332Z"}], "thread_id": "Thread-1", "execution_time": 0.002653837203979492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.not_null_bronze__subscriptions_subscription_start_date.6b36f9048e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_start_date\nfrom \"dev\".\"main\".\"bronze__subscriptions\"\nwhere subscription_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.081985Z", "completed_at": "2025-12-28T22:08:36.083604Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.083737Z", "completed_at": "2025-12-28T22:08:36.083740Z"}], "thread_id": "Thread-1", "execution_time": 0.0020570755004882812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.unique_bronze__subscriptions_subscription_id.8e7d19cbc9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    subscription_id as unique_field,\n    count(*) as n_records\n\nfrom \"dev\".\"main\".\"bronze__subscriptions\"\nwhere subscription_id is not null\ngroup by subscription_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.084395Z", "completed_at": "2025-12-28T22:08:36.086029Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.086160Z", "completed_at": "2025-12-28T22:08:36.086163Z"}], "thread_id": "Thread-1", "execution_time": 0.0020720958709716797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.not_null_silver__dim_customers_customer_id.86ded5bd11", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"dev\".\"main\".\"silver__dim_customers\"\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.086811Z", "completed_at": "2025-12-28T22:08:36.088505Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.088651Z", "completed_at": "2025-12-28T22:08:36.088654Z"}], "thread_id": "Thread-1", "execution_time": 0.0021500587463378906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.unique_silver__dim_customers_customer_id.2231f64a92", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"dev\".\"main\".\"silver__dim_customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.089333Z", "completed_at": "2025-12-28T22:08:36.090758Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.090915Z", "completed_at": "2025-12-28T22:08:36.090919Z"}], "thread_id": "Thread-1", "execution_time": 0.001898050308227539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.take_home_dbt.silver__fact_subscriptions", "compiled": true, "compiled_code": "select\n    subs.subscription_id, \n    subs.customer_id,\n    subs.plan_id,\n    subs.subscription_start_date,\n    subs.subscription_end_date,\n    plans.plan_monthly_price\nfrom \"dev\".\"main\".\"bronze__subscriptions\" as subs\nleft join \"dev\".\"main\".\"silver__dim_plans\" as plans\n    on subs.plan_id = plans.plan_id", "relation_name": "\"dev\".\"main\".\"silver__fact_subscriptions\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.091793Z", "completed_at": "2025-12-28T22:08:36.093835Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.094004Z", "completed_at": "2025-12-28T22:08:36.094009Z"}], "thread_id": "Thread-1", "execution_time": 0.0026311874389648438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.not_null_silver__dim_plans_plan_id.182380c4d3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_id\nfrom \"dev\".\"main\".\"silver__dim_plans\"\nwhere plan_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.094781Z", "completed_at": "2025-12-28T22:08:36.097517Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.097676Z", "completed_at": "2025-12-28T22:08:36.097680Z"}], "thread_id": "Thread-1", "execution_time": 0.003256082534790039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.unique_silver__dim_plans_plan_id.d0c0e76b30", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    plan_id as unique_field,\n    count(*) as n_records\n\nfrom \"dev\".\"main\".\"silver__dim_plans\"\nwhere plan_id is not null\ngroup by plan_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.098440Z", "completed_at": "2025-12-28T22:08:36.099888Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.100040Z", "completed_at": "2025-12-28T22:08:36.100044Z"}], "thread_id": "Thread-1", "execution_time": 0.0019550323486328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.take_home_dbt.gold__subscriptions_by_month", "compiled": true, "compiled_code": "with subs_trunc_date as (\n    select\n        subscription_id,\n        customer_id,\n        plan_id,\n        plan_monthly_price,\n         -- start reporting month at earliest subscription date's month:\n        date_trunc('month', subscription_start_date) as subscription_start_month,\n        -- end reporting at most recent completed month\n        -- using specific date (see vars in dbt_project.yml) rather than current_date for consistent reproducibility:\n        date_trunc('month', coalesce(subscription_end_date, cast('2025-12-27' as date))) as subscription_end_month\n    from \"dev\".\"main\".\"silver__fact_subscriptions\"\n)\n\n-- expand each subscription into one row per active month\n-- using a cross join on a date spine for each subscription's active months \n-- (assumes there will always be at least one active subscription in order\n-- to have monthly reporting)\nselect\n    cast(spine.month as date) as year_month,\n    subs.subscription_id,\n    subs.customer_id,\n    subs.plan_id,\n    subs.plan_monthly_price\nfrom subs_trunc_date as subs\ncross join generate_series(\n    subs.subscription_start_month,\n    subs.subscription_end_month,\n    interval '1 month'\n) as spine(month)\norder by \n    month desc,\n    customer_id", "relation_name": "\"dev\".\"main\".\"gold__subscriptions_by_month\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.100892Z", "completed_at": "2025-12-28T22:08:36.102734Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.102892Z", "completed_at": "2025-12-28T22:08:36.102896Z"}], "thread_id": "Thread-1", "execution_time": 0.0024247169494628906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.not_null_silver__fact_subscriptions_customer_id.45480c9c43", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"dev\".\"main\".\"silver__fact_subscriptions\"\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.103644Z", "completed_at": "2025-12-28T22:08:36.105380Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.105538Z", "completed_at": "2025-12-28T22:08:36.105541Z"}], "thread_id": "Thread-1", "execution_time": 0.002249002456665039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.not_null_silver__fact_subscriptions_plan_id.b9ffd27216", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_id\nfrom \"dev\".\"main\".\"silver__fact_subscriptions\"\nwhere plan_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.106315Z", "completed_at": "2025-12-28T22:08:36.108154Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.108307Z", "completed_at": "2025-12-28T22:08:36.108311Z"}], "thread_id": "Thread-1", "execution_time": 0.0023720264434814453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.not_null_silver__fact_subscriptions_subscription_id.ad571032aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"dev\".\"main\".\"silver__fact_subscriptions\"\nwhere subscription_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.109039Z", "completed_at": "2025-12-28T22:08:36.112381Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.112536Z", "completed_at": "2025-12-28T22:08:36.112541Z"}], "thread_id": "Thread-1", "execution_time": 0.003856182098388672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.relationships_silver__fact_subscriptions_customer_id__customer_id__ref_silver__dim_customers_.6eb34bbb01", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"dev\".\"main\".\"silver__fact_subscriptions\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"dev\".\"main\".\"silver__dim_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.113302Z", "completed_at": "2025-12-28T22:08:36.116718Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.116870Z", "completed_at": "2025-12-28T22:08:36.116875Z"}], "thread_id": "Thread-1", "execution_time": 0.003937959671020508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.relationships_silver__fact_subscriptions_plan_id__plan_id__ref_silver__dim_plans_.ba52c72aed", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select plan_id as from_field\n    from \"dev\".\"main\".\"silver__fact_subscriptions\"\n    where plan_id is not null\n),\n\nparent as (\n    select plan_id as to_field\n    from \"dev\".\"main\".\"silver__dim_plans\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.117596Z", "completed_at": "2025-12-28T22:08:36.119248Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.119381Z", "completed_at": "2025-12-28T22:08:36.119384Z"}], "thread_id": "Thread-1", "execution_time": 0.0020990371704101562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.unique_silver__fact_subscriptions_subscription_id.af188ef197", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    subscription_id as unique_field,\n    count(*) as n_records\n\nfrom \"dev\".\"main\".\"silver__fact_subscriptions\"\nwhere subscription_id is not null\ngroup by subscription_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.120019Z", "completed_at": "2025-12-28T22:08:36.121300Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.121433Z", "completed_at": "2025-12-28T22:08:36.121436Z"}], "thread_id": "Thread-1", "execution_time": 0.0017170906066894531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.take_home_dbt.gold__logo_churn_by_month", "compiled": true, "compiled_code": "-- monthly logo churn rate calculation: \n-- (# customers active last month but not this month [aka churned]) / (# customers active last month)\n\n-- each month and each (distinct) customer\nwith monthly_customers as (\n    select distinct\n        year_month,\n        customer_id\n    from \"dev\".\"main\".\"gold__subscriptions_by_month\"\n),\n\n-- get maximum month for churn calculation logic\nupper_month_bound as (\n    select\n        max(year_month) as max_month\n    from monthly_customers\n),\n\n-- number of customers churned per month (present in month M but not in month M+1; numerator of churn rate)\nchurned as (\n    select\n        prev.year_month + interval '1 month' as year_month,\n        count(distinct prev.customer_id) as churned_customers\n    from monthly_customers prev\n    left join monthly_customers curr\n        on curr.customer_id = prev.customer_id\n        and curr.year_month = prev.year_month + interval '1 month'\n    where \n        curr.customer_id is null\n        -- don't count churn for \"future months\"\n        and (prev.year_month + interval '1 month') <= (select max_month from upper_month_bound)\n    group by \n        all\n),\n\n-- get number of customers active last month (denominator of churn rate)\ncustomers_active_last_month as (\n    select\n        year_month + interval '1 month' as year_month,\n        count(distinct customer_id) as active_customers_last_month\n    from monthly_customers\n    group by \n        all\n)\n\n-- calculate churn rate, include numerator and denominator\nselect\n    cast(active.year_month as date) as year_month,\n    coalesce(churned.churned_customers, 0) as churned_customers,\n    active.active_customers_last_month,\n    try_cast(coalesce(churned.churned_customers, 0) * 1.0\n    / nullif(active.active_customers_last_month, 0) as decimal(10,2)) as logo_churn_rate\nfrom customers_active_last_month as active\nleft join churned\n  on active.year_month = churned.year_month\norder by \n    active.year_month", "relation_name": "\"dev\".\"main\".\"gold__logo_churn_by_month\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.122190Z", "completed_at": "2025-12-28T22:08:36.126429Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.126577Z", "completed_at": "2025-12-28T22:08:36.126580Z"}], "thread_id": "Thread-1", "execution_time": 0.004739999771118164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.dbt_utils_unique_combination_of_columns_gold__subscriptions_by_month_year_month__subscription_id.a121efc5fb", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year_month, subscription_id\n    from \"dev\".\"main\".\"gold__subscriptions_by_month\"\n    group by year_month, subscription_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.127248Z", "completed_at": "2025-12-28T22:08:36.128928Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.129065Z", "completed_at": "2025-12-28T22:08:36.129068Z"}], "thread_id": "Thread-1", "execution_time": 0.002135038375854492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.not_null_gold__subscriptions_by_month_customer_id.2f99365722", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"dev\".\"main\".\"gold__subscriptions_by_month\"\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.129708Z", "completed_at": "2025-12-28T22:08:36.131871Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.132002Z", "completed_at": "2025-12-28T22:08:36.132005Z"}], "thread_id": "Thread-1", "execution_time": 0.0026030540466308594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.not_null_gold__subscriptions_by_month_plan_id.1734cde705", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_id\nfrom \"dev\".\"main\".\"gold__subscriptions_by_month\"\nwhere plan_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.132639Z", "completed_at": "2025-12-28T22:08:36.134343Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.134477Z", "completed_at": "2025-12-28T22:08:36.134479Z"}], "thread_id": "Thread-1", "execution_time": 0.0021409988403320312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.not_null_gold__subscriptions_by_month_plan_monthly_price.da33ac4d53", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_monthly_price\nfrom \"dev\".\"main\".\"gold__subscriptions_by_month\"\nwhere plan_monthly_price is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.135114Z", "completed_at": "2025-12-28T22:08:36.136703Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.136835Z", "completed_at": "2025-12-28T22:08:36.136838Z"}], "thread_id": "Thread-1", "execution_time": 0.002026081085205078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.not_null_gold__subscriptions_by_month_subscription_id.e02037d284", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"dev\".\"main\".\"gold__subscriptions_by_month\"\nwhere subscription_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.137461Z", "completed_at": "2025-12-28T22:08:36.139065Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.139210Z", "completed_at": "2025-12-28T22:08:36.139213Z"}], "thread_id": "Thread-1", "execution_time": 0.0020499229431152344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.not_null_gold__subscriptions_by_month_year_month.7ede7304c7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year_month\nfrom \"dev\".\"main\".\"gold__subscriptions_by_month\"\nwhere year_month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.139897Z", "completed_at": "2025-12-28T22:08:36.141183Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.141315Z", "completed_at": "2025-12-28T22:08:36.141318Z"}], "thread_id": "Thread-1", "execution_time": 0.0017511844635009766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.take_home_dbt.gold__report_metrics_by_month", "compiled": true, "compiled_code": "select\n    subs.year_month,\n    count(distinct subs.customer_id) as active_customers,\n    sum(subs.plan_monthly_price) as monthly_recurring_revenue,\n    churns.logo_churn_rate\nfrom \"dev\".\"main\".\"gold__subscriptions_by_month\" as subs\nleft join \"dev\".\"main\".\"gold__logo_churn_by_month\" as churns\n    on subs.year_month = churns.year_month\ngroup by\n    all\norder by\n    subs.year_month desc", "relation_name": "\"dev\".\"main\".\"gold__report_metrics_by_month\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.142070Z", "completed_at": "2025-12-28T22:08:36.143845Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.143983Z", "completed_at": "2025-12-28T22:08:36.143986Z"}], "thread_id": "Thread-1", "execution_time": 0.0022919178009033203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.dbt_utils_accepted_range_gold__logo_churn_by_month_active_customers_last_month__True__0.c51581e3f5", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from \"dev\".\"main\".\"gold__logo_churn_by_month\"\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not active_customers_last_month >= 0\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.144650Z", "completed_at": "2025-12-28T22:08:36.146909Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.147047Z", "completed_at": "2025-12-28T22:08:36.147050Z"}], "thread_id": "Thread-1", "execution_time": 0.002707958221435547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.dbt_utils_accepted_range_gold__logo_churn_by_month_churned_customers__True__0.285890e029", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from \"dev\".\"main\".\"gold__logo_churn_by_month\"\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not churned_customers >= 0\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.147707Z", "completed_at": "2025-12-28T22:08:36.149536Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.149672Z", "completed_at": "2025-12-28T22:08:36.149675Z"}], "thread_id": "Thread-1", "execution_time": 0.0022716522216796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.dbt_utils_accepted_range_gold__logo_churn_by_month_logo_churn_rate__True__1__0.b6bd3afd81", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from \"dev\".\"main\".\"gold__logo_churn_by_month\"\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not logo_churn_rate >= 0\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not logo_churn_rate <= 1\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.150341Z", "completed_at": "2025-12-28T22:08:36.151984Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.152119Z", "completed_at": "2025-12-28T22:08:36.152122Z"}], "thread_id": "Thread-1", "execution_time": 0.0020978450775146484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.not_null_gold__logo_churn_by_month_year_month.abd396d32c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year_month\nfrom \"dev\".\"main\".\"gold__logo_churn_by_month\"\nwhere year_month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.152814Z", "completed_at": "2025-12-28T22:08:36.154502Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.154640Z", "completed_at": "2025-12-28T22:08:36.154643Z"}], "thread_id": "Thread-1", "execution_time": 0.002173185348510742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.dbt_utils_accepted_range_gold__report_metrics_by_month_active_customers__True__0.8812c863e4", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from \"dev\".\"main\".\"gold__report_metrics_by_month\"\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not active_customers >= 0\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.155305Z", "completed_at": "2025-12-28T22:08:36.157101Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.157235Z", "completed_at": "2025-12-28T22:08:36.157238Z"}], "thread_id": "Thread-1", "execution_time": 0.002248048782348633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.dbt_utils_accepted_range_gold__report_metrics_by_month_logo_churn_rate__True__0.6dde69d360", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from \"dev\".\"main\".\"gold__report_metrics_by_month\"\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not logo_churn_rate >= 0\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.157882Z", "completed_at": "2025-12-28T22:08:36.160069Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.160202Z", "completed_at": "2025-12-28T22:08:36.160205Z"}], "thread_id": "Thread-1", "execution_time": 0.002633333206176758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.dbt_utils_accepted_range_gold__report_metrics_by_month_monthly_recurring_revenue__True__0.9529003923", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from \"dev\".\"main\".\"gold__report_metrics_by_month\"\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not monthly_recurring_revenue >= 0\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-28T22:08:36.160837Z", "completed_at": "2025-12-28T22:08:36.162404Z"}, {"name": "execute", "started_at": "2025-12-28T22:08:36.162536Z", "completed_at": "2025-12-28T22:08:36.162539Z"}], "thread_id": "Thread-1", "execution_time": 0.001992940902709961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.take_home_dbt.not_null_gold__report_metrics_by_month_year_month.5a04e90411", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year_month\nfrom \"dev\".\"main\".\"gold__report_metrics_by_month\"\nwhere year_month is null\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 0.19842195510864258, "args": {"require_all_warnings_handled_by_warn_error": false, "state_modified_compare_more_unrendered_values": false, "skip_nodes_if_on_run_start_fails": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "write_json": true, "log_path": "/Users/tesshamzeh/take_home_dbt/logs", "send_anonymous_usage_stats": true, "source_freshness_run_project_hooks": true, "log_file_max_bytes": 10485760, "profiles_dir": "/Users/tesshamzeh/.dbt", "require_batched_execution_for_custom_microbatch_strategy": false, "static_parser": true, "use_colors": true, "require_yaml_configuration_for_mf_time_spines": false, "compile": true, "empty_catalog": false, "partial_parse_file_diff": true, "show_resource_report": false, "upload_to_artifacts_ingest_api": false, "version_check": true, "log_level_file": "debug", "log_format": "default", "show_all_deprecations": false, "quiet": false, "which": "generate", "require_generic_test_arguments_property": true, "select": [], "state_modified_compare_vars": false, "invocation_command": "dbt docs generate", "indirect_selection": "eager", "introspect": true, "require_nested_cumulative_type_params": false, "partial_parse": true, "favor_state": false, "log_format_file": "debug", "validate_macro_args": false, "defer": false, "cache_selected_only": false, "project_dir": "/Users/tesshamzeh/take_home_dbt", "require_resource_names_without_spaces": true, "require_explicit_package_overrides_for_builtin_materializations": true, "populate_cache": true, "static": false, "macro_debugging": false, "exclude": [], "use_colors_file": true, "print": true, "strict_mode": false, "printer_width": 80, "vars": {}, "use_fast_test_edges": false, "log_level": "info"}}